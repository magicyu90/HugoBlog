---
title: Pandas使用 (二)
date: 2019-11-11 13:58:25
tags: [pandas]
categories: Python
---
本文主要以Pandas的案例进行讲解，并介绍在平时使用过程中的一些小技巧。

<!-- more -->

### Axis-轴的概念
axis：按那个方向检索 0：按逐行索引向下走 1;按逐列 向右走
在drop中使用axis=1实际上是删掉了一列，而在mean中实际上是计算的行平均值，而不是列的平均值。
实际上axis = 1，指的是沿着行求所有列的平均值，代表了横轴，那axis = 0，就是沿着列求所有行的平均值，代表了纵轴。
{% asset_img axis.png 示意图 %}

### apply使用
如果我们想创建一个新列，其中包含其他列内容作为输入，那么apply函数会非常有用。
``` python
In [45]: df = pd.DataFrame({ 'c1':[ 'high' ,'high', 'low', 'low'], 'c2': [0, 23, 17, 4]})
In [46]: df
Out[46]: 
     c1  c2
0  high   0
1  high  23
2   low  17
3   low   4
```
定义一个方法
``` python
In [47]: def rule(x,y):
    ...:     if x=='high' and y>10:
    ...:         return 1
    ...:     else:
    ...:         return 0
    ...:     
In [48]: df['new']=df.apply(lambda x : rule(x['c1'],x['c2']),axis=1)
In [49]: df
Out[49]: 
     c1  c2  new
0  high   0    0
1  high  23    1
2   low  17    0
3   low   4    0
```

### DataFrame删除行和列
数据准备如下：
``` python
In [1]:
import numpy as np
import pandas as pd
 
odata = pd.read_csv('example.csv')
odata

Out[1]:
date    spring  summer  autumn  winter
0   2000    12.2338809  16.9073011333   15.6923831333   14.0859622333
1   2001    12.8474805667   16.7504687333   14.5140663667   13.5037456
2   2002    13.558175   17.2033926  15.6999475  13.2336524667
3   2003    12.6547247  16.8949153333   15.6614647  12.8434786667
4   2004    13.2537298  17.0469665667   15.2090537667   14.3647912
5   2005    13.4443049  16.7459822  16.6221879667   11.6108225667
6   2006    13.5056956667   16.8335785667   15.4979282  12.1993436333
7   2007    13.4885262333   16.6677328333   15.8170143667   13.7438216
8   2008    13.1515319  16.4865069333   15.7295728667   12.9323358667
9   2009    13.4577154333   16.6392378333   18.2601799667   12.6531594333
10  2010    13.1945485  16.7286889  15.4263526667   13.8833583
11  2011    14.3477941667   16.6894210333   14.1765804333   12.3665419667
12  2012    13.6050867  17.1305677333   14.7179677667   13.2925524333
13  2013    13.0279078667   17.3861934333   16.2034549667   13.1861213333
14  2014    12.7466816333   16.5442868667   14.7367682  12.8706512467
15  2015    13.465904   16.5061231667   12.4424366333   11.0181384
16  season  spring  summer  autumn  winter
17  slope   0.037969137402  -0.0116468916667    -0.0791384411275    -0.0776527455294
```

#### 删除行
.drop()方法如果不设置参数**inplace=True**，则只能在生成的新数据块中实现删除效果，而不能删除原有数据块的相应行。如果inplace=True则原有数据块的相应行被删除
``` python
In [4]:
odata.drop(odata.index[[16,17]],inplace=True)
odata

Out[4]:
date    spring  summer  autumn  winter
0   2000    12.2338809  16.9073011333   15.6923831333   14.0859622333
1   2001    12.8474805667   16.7504687333   14.5140663667   13.5037456
2   2002    13.558175   17.2033926  15.6999475  13.2336524667
3   2003    12.6547247  16.8949153333   15.6614647  12.8434786667
4   2004    13.2537298  17.0469665667   15.2090537667   14.3647912
5   2005    13.4443049  16.7459822  16.6221879667   11.6108225667
6   2006    13.5056956667   16.8335785667   15.4979282  12.1993436333
7   2007    13.4885262333   16.6677328333   15.8170143667   13.7438216
8   2008    13.1515319  16.4865069333   15.7295728667   12.9323358667
9   2009    13.4577154333   16.6392378333   18.2601799667   12.6531594333
10  2010    13.1945485  16.7286889  15.4263526667   13.8833583
11  2011    14.3477941667   16.6894210333   14.1765804333   12.3665419667
12  2012    13.6050867  17.1305677333   14.7179677667   13.2925524333
13  2013    13.0279078667   17.3861934333   16.2034549667   13.1861213333
14  2014    12.7466816333   16.5442868667   14.7367682  12.8706512467
15  2015    13.465904   16.5061231667   12.4424366333   11.0181384
```

#### 删除列：
#### del方法
#### .pop()方法
.pop方法可以将所选列从原数据块中弹出，原数据块不再保留该列
#### .drop()方法
drop方法既可以保留原数据块中的所选列，也可以删除，这取决于参数inplace
``` python
In [8]:
withoutSummer = odata.drop(['summer'],axis=1)
withoutSummer

Out[8]:
autumn  winter
0   15.6923831333   14.0859622333
1   14.5140663667   13.5037456
2   15.6999475  13.2336524667
3   15.6614647  12.8434786667
4   15.2090537667   14.3647912
5   16.6221879667   11.6108225667
6   15.4979282  12.1993436333
7   15.8170143667   13.7438216
8   15.7295728667   12.9323358667
9   18.2601799667   12.6531594333
10  15.4263526667   13.8833583
11  14.1765804333   12.3665419667
12  14.7179677667   13.2925524333
13  16.2034549667   13.1861213333
14  14.7367682  12.8706512467
15  12.4424366333   11.0181384

In [9]:
odata

Out[9]:
summer  autumn  winter
0   16.9073011333   15.6923831333   14.0859622333
1   16.7504687333   14.5140663667   13.5037456
2   17.2033926  15.6999475  13.2336524667
3   16.8949153333   15.6614647  12.8434786667
4   17.0469665667   15.2090537667   14.3647912
5   16.7459822  16.6221879667   11.6108225667
6   16.8335785667   15.4979282  12.1993436333
7   16.6677328333   15.8170143667   13.7438216
8   16.4865069333   15.7295728667   12.9323358667
9   16.6392378333   18.2601799667   12.6531594333
10  16.7286889  15.4263526667   13.8833583
11  16.6894210333   14.1765804333   12.3665419667
12  17.1305677333   14.7179677667   13.2925524333
13  17.3861934333   16.2034549667   13.1861213333
14  16.5442868667   14.7367682  12.8706512467
15  16.5061231667   12.4424366333   11.0181384
```
当inplace=True时.drop()执行内部删除，不返回任何值，原数据发生改变
``` python
In [10]:
withoutWinter = odata.drop(['winter'],axis=1,inplace=True)
type(withoutWinter)

Out[10]:
NoneType

In [11]:
odata

Out[11]:
summer  autumne
0   16.9073011333   15.6923831333
1   16.7504687333   14.5140663667
2   17.2033926  15.6999475
3   16.8949153333   15.6614647
4   17.0469665667   15.2090537667
5   16.7459822  16.6221879667
6   16.8335785667   15.4979282
7   16.6677328333   15.8170143667
8   16.4865069333   15.7295728667
9   16.6392378333   18.2601799667
10  16.7286889  15.4263526667
11  16.6894210333   14.1765804333
12  17.1305677333   14.7179677667
13  17.3861934333   16.2034549667
14  16.5442868667   14.7367682
15  16.5061231667   12.4424366333
```

### 参考资料
------
* [Pandas.DataFrame删除行和列](https://www.jianshu.com/p/67e67c7034f6)